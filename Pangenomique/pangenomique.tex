\part{Du génome au pangénome}

Avec l'essor de la pangénomique, de plus en plus d'outils ont été développés. En 2020, le LABGeM propose son outil de construction et de partitionnement de graphe de pangénome : PPanGGOLiN \cite{gautreau_ppanggolin_2020}, développé dans le cadre de 2 thèses. La première, menée par Guillaume Gautreau, a conduit à la création du graphe de pangénome et à son partitionnement. La seconde, réalisée par Adelme Bazin, a contribué au développement des méthodes précédentes, avec également l’analyse des parties variables du graphe. Ces travaux ont conduit au développement de la méthode panRGP \cite{bazin_panrgp_2020} pour l’identification des régions de plasticité génomique (RPG) et des spots d'insertion ; suivie de la méthode panModule \cite{bazin_panmodule_2021} pour la prédiction de modules conservés.

Au cours de ma thèse, j'ai intégré de nouvelles méthodes dans PPanGGOLiN, notamment pour la recherche de contextes génomiques conservés. Puis j'ai initié et participé à l'amélioration du logiciel et de son environnement : (réusinage de code, maintenance, documentation\dots) aboutissant à la distribution d'une version 2.0 de PPanGGOLiN. Ces développements seront présentés dans ce chapitre.

\chapter{La suite logicielle PPanGGOLiN : construction et analyse d'un pangénome}

Les premières approches pangénomiques se fondaient sur une dichotomie entre le génome \textit{core}, regroupant les gènes conservés dans toutes les souches d'une espèce, et le génome \textit{accessoire}, constitué des gènes variables \cite{tettelin_genome_2005}. Toutefois, avec l'augmentation du nombre de génomes disponibles, les pangénomes intègrent une quantité croissante de séquences. Cependant, ces séquences peuvent être incomplètes ou contenir des erreurs de séquençage, entraînant une absence apparente de certains gènes dans des génomes où ils devraient pourtant être présents. Par conséquent, un gène qui devrait faire partie du génome \textit{core} peut être mal classé comme appartenant au génome \textit{accessory}. Ce phénomène contribue à une réduction apparente de la taille du génome \textit{core}. Pour compenser cet effet, une version "relâchée" du génome \textit{core} a été proposée. Ce \textit{core} relâché, aussi appelé \textbf{génome \textit{persistent}}, correspond aux gènes les plus fréquents dans les génomes, \textit{i.e.} dont la présence est supérieure à un seuil minimal défini pour être considéré comme conservé. Par exemple, Roary \cite{page_roary_2015} applique un seuil de 95 \%, bien que celui-ci doive être ajusté en fonction du contexte biologique spécifique \cite{tonder_defining_2014}.

Cependant, cette bipartition du pangénome devient de plus en plus limitante à mesure que le nombre de génomes séquencés augmente. Les travaux de Makarova \textit{et al.} \cite{makarova_clusters_2007}, suivis par ceux de Koonin et Wolf \cite{koonin_genomics_2008}, montrent que la répartition des clusters de familles homologues, COGs \cite{tatusov_cog_2000} et EggNogs \cite{jensen_eggnog_2008} (respectivement), en fonction du nombre d'organismes, suit une structure en trois catégories. C'est pourquoi, pour mieux refléter la diversité génétique, certains outils, comme micropan \cite{snipen_micropan_2015}, proposent une classification en trois catégories : (\textit{i}) le génome \textit{persistent}, (\textit{ii}) le génome \textit{shell}, correspondant aux gènes présents dans un sous-ensemble de génomes, et (\textit{iii}) le génome \textit{cloud}, qui regroupe les gènes rares ou spécifiques à certaines souches. Cette trichotomie offre une vision plus nuancée de la distribution des gènes, mais elle reste limitée lorsqu’il s’agit d’espèces à forte hétérogénéité génomique \cite{moldovan_pangenomic_2018}.

\bigskip

Pour surmonter ces limitations, PPanGGOLiN \cite{gautreau_ppanggolin_2020} propose une approche alternative combinant trois éléments clés : (\textit{i}) l'utilisation des matrices de présence/absence des familles de gènes, (\textit{ii}) l’identification automatique du nombre optimal de partitions et (\textit{iii}) la prise en compte du voisinage génomique des gènes. Ainsi, PPanGGOLiN construit un graphe de pangénome, où les n\oe uds représentent les familles de gènes et les arêtes reflètent leur relation de voisinage dans les génomes. Ce graphe est ensuite partitionné, grâce à un algorithme statistique et de machine learning, sans seuil et sans limites du nombre de parties. Ces parties sont reclassées en 3 catégories de génome : le \textit{persistent} (analogue au \textit{core} relâché), le \textit{shell} et le \textit{cloud}. Cette approche permet de regrouper les familles en fonction de leur distribution dans les génomes et de leur contexte génomique. 

\newpage

À partir de ce graphe de pangénome partitionné, PPanGGOLiN intègre 2 méthodes pour l'analyse du pangénome. La première méthode panRGP \cite{bazin_panrgp_2020} permet d’identifier efficacement les portions variables du pangénome, correspondant aux îlots génomiques, aux plasmides et aux gènes différentiellement perdus dans l'évolution. De plus, en identifiant ces \textbf{régions de plasticités génomiques} (RGPs), panRGP peut identifier des bordures de familles persistantes, partagées par plusieurs RGPs, correspondant à des \textbf{spots d'insertion}. PanRGP offre ainsi une solution prenant en compte toute la diversité génomique dépassant les limites des méthodes traditionnelles de génomique comparative.

La seconde méthode, panModule \cite{bazin_panmodule_2021}, exploite le graphe de pangénome pour identifier des \textbf{modules} génomiques. Ces modules correspondent à un ensemble non chevauchant de familles de gènes variables cooccurrentes et colocalisées. 

Ces méthodes  ont été intégrées dans la suite logicielle PPanGGOLiN, un outil open source écrit en Python et C, compatible avec les systèmes Linux et MacOS. PPanGGOLiN fonctionne en ligne de commande et met à disposition une série d’analyses permettant d’exploiter le graphe de pangénome pour une meilleure compréhension de la diversité et de la dynamique des génomes. Grâce à sa modularité, chaque commande permet d’exécuter une analyse spécifique et de croiser les résultats obtenus afin d’affiner l’interprétation des données génomiques. En tant que logiciel open source, il est librement accessible sur GitHub \cite{https://github.com/labgem/PPanGGOLiN} et peut être facilement installé via Conda \cite{https://anaconda.org/bioconda/ppanggolin}, facilitant ainsi son intégration dans divers environnements bioinformatiques.

\input{Pangenomique/PPanGGOLiN}

\input{Pangenomique/Developpement}

\input{Pangenomique/Apiose}

\chapter{Conclusion et perspectives}

\section{PPanGGOLiN : bilan de la version 2.0}

Depuis son lancement en 2020, PPanGGOLiN s’est imposé comme un outil pour les analyses pangénomiques, comptabilisant plus de 170 citations, auquel il faut ajouter 37 citations pour panRGP. Il offre une approche innovante et efficace de construction et de partitionnement des graphes de pangénomes. Le logiciel PPanGGOLiN a été intégré dans la plateforme MicroScope \cite{vallenet_microscope_2020}, pour fournir un niveau d'information pangénomique dans les résultats d'annotation des génomes procaryotes. Il est également disponible sur la plateforme Galaxy France, maintenue par l'Institut Français de Bioinformatique (IFB). Son utilisation dépasse désormais le monde académique, avec les entreprises privées : EVOTEC et SYNGENTA, qui utilisent PPanGGOLiN pour leurs projets de R\&D. The Carpentries (\url{https://carpentries.org/}), une entreprise dédiée à la formation en développement informatique et en data science, propose PPanGGOLiN dans un cours en ligne dédié à la pangénomique procaryote (\url{https://github.com/paumayell/pangenomics}).

Cette reconnaissance s’est concrétisée le 29 novembre 2023, lorsque PPanGGOLiN a reçu le \textbf{Prix "science ouverte du logiciel libre de la recherche", "espoir" de la catégorie 'Scientifique et technique'}\footnote{\href{https://www.ouvrirlascience.fr/remise-des-prix-science-ouverte-du-logiciel-libre-de-la-recherche-2023/}{ouvrirlascience.fr/remise-des-prix-science-ouverte-du-logiciel-libre-de-la-recherche-2023/}}, décerné par le Ministère  de l'Enseignement supérieur et de la Recherche. Cette distinction souligne non seulement la qualité scientifique et technique du logiciel, mais aussi son engagement envers les principes de la science ouverte.

Avec l’arrivée de la version 2.0, PPanGGOLiN intègre des améliorations méthodologiques, techniques et ergonomiques visant à renforcer son efficacité, sa robustesse et son accessibilité.

D’un point de vue méthodologique, plusieurs nouvelles fonctionnalités ont été intégrées pour enrichir et affiner l’analyse des pangénomes. L’ajout de métadonnées permet désormais d’annoter l’ensemble des éléments du pangénome (gènes, contigs, génomes, familles, arêtes, RGPs, spots et modules), améliorant ainsi la contextualisation et l’exploration des résultats. La projection des résultats du pangénome sur des génomes externes, ouvre la voie à une analyse comparative plus fine, facilitant l’intégration des pangénomes avec de nouvelles données génomiques. Par ailleurs, la clusterisation des RGPs apporte une nouvelle perspective en permettant de regrouper les régions de plasticité génomique en fonction de leur contenu en gènes, offrant ainsi un moyen de caractériser les dynamiques évolutives au sein d’un pangénome.

D’un point de vue technique, plusieurs optimisations ont considérablement amélioré les performances et l’efficacité de PPanGGOLiN. L’intégration de Pyrodigal \cite{larralde_pyrodigal_2022} en remplacement de Prodigal \cite{hyatt_prodigal_2010} pour l’annotation des génomes a permis de réduire la consommation mémoire et d’accélérer le traitement des données en évitant la création de fichiers intermédiaires. La réorganisation des fonctions de lecture et l’optimisation du format HDF5 ont permis de réduire la taille des fichiers et d’accélérer les temps de chargement, rendant ainsi l’outil plus efficace et mieux adapté aux analyses à grande échelle.

En termes de maintenabilité et de développement, des efforts importants ont été réalisés pour garantir la pérennité de PPanGGOLiN en tant que logiciel open source. L’adoption des bonnes pratiques de développement en Python (PEP) a permis d’améliorer la lisibilité et l’homogénéité du code, facilitant ainsi les contributions de nouveaux développeurs. L’automatisation du formatage du code avec Black (\url{https://github.com/psf/black}) et la mise en place d’une infrastructure de tests robustes (tests unitaires, tests d’intégration, tests fonctionnels) garantissent la stabilité du logiciel et minimisent l’introduction de bogues imprévus lors des mises à jour.

Enfin, une attention particulière a été portée à l’expérience utilisateur, un aspect essentiel pour un outil principalement destiné aux microbiologistes. La documentation a été entièrement réécrite, rendant son contenu plus accessible, structuré et pédagogique, et elle est désormais disponible sur le site ReadTheDocs. La gestion des messages d’erreur a également été améliorée, avec des messages plus explicites, facilitant aussi bien la correction des erreurs par les utilisateurs que le débogage par les développeurs. L’intégration de fichiers de configuration pour l’exécution des workflows simplifie l’utilisation de PPanGGOLiN dans des pipelines d’analyse complexes et renforce la reproductibilité des analyses, en accord avec les principes FAIR (Findable, Accessible, Interoperable, Reusable).

L'ensemble des développements et améliorations ont pu être présentés dans plusieurs conférences, sous forme de \textit{flash talk} à local pangénome 2023 \cite{mainguy_ppanggolin_2023} et de démonstration à JOBIM 2024. Un article présentant la version 2 de PPanGGOLiN est également en cours de rédaction et sera prochainement soumis.

\section{Évolution de PPanGGOLiN : vers une version 3.0 ?}

L’évolution de PPanGGOLiN ne s’arrête pas avec cette version 2.0. Plusieurs axes de développement sont envisagés pour renforcer encore davantage ses capacités analytiques, améliorer ses performances et étendre ses possibilités d’utilisation.

L’implémentation actuelle de PPanGGOLiN repose sur Python et C, mais l’utilisation d’un autre langage pourrait permettre d’améliorer encore ses performances, notamment pour la gestion de grands volumes de données. Lors de la réécriture du code, une grande partie des variables ont été typées, ce qui est une étape préliminaire importante à un passage de Python vers Cython, un langage intermédiaire entre C et Python. L'intégration d'autres langages comme Rust pour la parallélisation ou Julia pour l’optimisation des calculs pourrait également être envisagée pour certaines parties critiques du code. Une de ces parties serait notamment celle en C qui exécute l'algorithme NEM et qui n'a pas été revue. 

Avec la version 2, PPanGGOLiN permet désormais de projeter le pangénome sur un génome externe. Pour aller encore plus loin, nous voudrions ajouter la possibilité d'intégrer de nouveaux génomes dans un pangénome déjà existant, sans avoir à le reconstruire entièrement. Cette fonctionnalité permettrait une mise à jour progressive du pangénome à mesure que de nouvelles données sont disponibles, notamment dans le cadre de la création d'une base de données de pangénomes.

\newpage
Cette base de données de pangénome est d'ailleurs en développement au LABGeM, sous le nom de PanGBank. Pour faciliter l'accès au pangénome et pour donner encore plus d'intérêt à la commande de projection, Jean Mainguy en train de développer une API (interface de programmation d'application ou \textit{application programming interface} en anglais) qui permettrait de télécharger un pangénome depuis PanGBank. Cela accélérerait les analyses et faciliterait la standardisation des jeux de données pangénomiques.

Une autre avancée méthodologique majeure serait de représenter et stocker les séquences du pangénome sous forme de graphe de variants, plutôt que comme des séquences linéaires. Cette approche permettrait de grandement diminuer la taille des fichiers de pangénome.

Pour terminer, les améliorations présentées dans la version 2.0 de PPanGGOLiN ont été étroitement pensées pour l’intégration de PPanGGOLiN dans PANORAMA (cf. \autoref{part:PANORAMA}). PANORAMA intègre des méthodes pour la comparaison de pangénomes et l’utilisation de la recherche de contextes génomiques pour identifier des systèmes biologiques conservés ou variables. Ces approches se basent sur le graphe de pangénome partitionné de PPanGGOLiN et pourraient permettre de mieux comprendre la dynamique évolutive des génomes microbiens et la diversité métabolique qu'ils contiennent.